{"version":3,"file":"vue.js","sources":["../src/utils.js","../src/gloablAPI.js","../src/compiler/parse.js","../src/compiler/index.js","../src/observe/dep.js","../src/observe/watcher.js","../src/vdom/index.js","../src/vdom/patch.js","../src/lifecycle.js","../src/observe/array.js","../src/observe/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["const strats = {};\r\nconst LIFECYCLE = [\r\n    'beforeCreate',\r\n    'created'\r\n]\r\nLIFECYCLE.forEach(hook => {\r\n    strats[hook] = function (p, c) {\r\n        //  {} {created:function(){}}   => {created:[fn]}\r\n        // {created:[fn]}  {created:function(){}} => {created:[fn,fn]}\r\n        if (c) { // 如果儿子有 父亲有   让父亲和儿子拼在一起\r\n            if (p) {\r\n                return p.concat(c);\r\n            } else {\r\n                return [c]; // 儿子有父亲没有 ，则将儿子包装成数组\r\n            }\r\n        } else {\r\n            return p; // 如果儿子没有则用父亲即可\r\n        }\r\n    }\r\n})\r\n\r\nstrats.components  = function(parentVal,childVal){\r\n    const res = Object.create(parentVal);\r\n\r\n    if(childVal){\r\n        for(let key in childVal){\r\n            res[key] = childVal[key]; // 返回的是构造的对象 可以拿到父亲原型上的属性，并且将儿子的都拷贝到自己身上\r\n        }\r\n    }\r\n\r\n    return res;\r\n}\r\n \r\n\r\nexport function mergeOptions(parent, child) {\r\n    const options = {};\r\n    for (let key in parent) { // 循环老的  {}\r\n        mergeField(key);\r\n    }\r\n    for (let key in child) { // 循环老的   {a:1}\r\n        if (!parent.hasOwnProperty(key)) {\r\n            mergeField(key);\r\n        }\r\n    }\r\n    function mergeField(key) {\r\n        // 策略模式 用策略模式减少if /else\r\n        if (strats[key]) {\r\n            options[key] = strats[key](parent[key], child[key])\r\n        } else {\r\n            // 如果不在策略中则以儿子为主\r\n            options[key] = child[key] || parent[key]; // 优先采用儿子，在采用父亲\r\n        }\r\n    }\r\n    return options;\r\n\r\n}","\r\nimport { mergeOptions } from './utils'\r\n\r\n\r\n\r\n\r\n\r\nexport function initGlobalAPI(Vue) {\r\n    // 静态方法\r\n    Vue.options = {\r\n        _base: Vue\r\n    }\r\n    Vue.mixin = function (mixin) {\r\n        // 我们期望将用户的选项和 全局的options进行合并 '\r\n        this.options = mergeOptions(this.options, mixin);\r\n        return this;\r\n    }\r\n\r\n\r\n    // 可以手动创造组件进行挂载\r\n    Vue.extend = function (options) {\r\n        // 就是实现根据用户的参数 返回一个构造函数而已\r\n        function Sub(options = {}) { // 最终使用一个组件 就是new一个实例\r\n            this._init(options); // 就是默认对子类进行初始化操作\r\n        }\r\n        Sub.prototype = Object.create(Vue.prototype)  // Sub.prototype.__proto__ === Vue.prototype\r\n        Sub.prototype.constructor = Sub;\r\n\r\n        // 希望将用户的传递的参数 和全局的Vue.options来合并\r\n        Sub.options = mergeOptions(Vue.options, options); // 保存用户传递的选项\r\n        return Sub\r\n    }\r\n    Vue.options.components = {} // 全局的指令 Vue.otpions.directives\r\n    Vue.component = function (id, definition) {\r\n\r\n        // 如果definition已经是一个函数了 说明用户自己调用了Vue.extend\r\n        definition = typeof definition === 'function' ? definition : Vue.extend(definition)\r\n        Vue.options.components[id] = definition\r\n    }\r\n\r\n}","const ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`;\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`;\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 他匹配到的分组是一个 标签名  <xxx 匹配到的是开始 标签的名字\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`);  // 匹配的是</xxxx>  最终匹配到的分组就是结束标签的名字\r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/;  // 匹配属性\r\n// 第一个分组就是属性的key value 就是 分组3/分组4/分组五\r\nconst startTagClose = /^\\s*(\\/?)>/;  // <div> <br/>\r\n\r\n\r\n// vue3 采用的不是使用正则\r\n// 对模板进行编译处理  \r\n\r\n\r\nexport function parseHTML(html) { // html最开始肯定是一个  </div>\r\n\r\n    const ELEMENT_TYPE = 1;\r\n    const TEXT_TYPE = 3;\r\n    const stack = []; // 用于存放元素的\r\n    let currentParent; // 指向的是栈中的最后一个\r\n    let root;\r\n\r\n    // 最终需要转化成一颗抽象语法树\r\n    function createASTElement(tag, attrs) {\r\n        return {\r\n            tag,\r\n            type: ELEMENT_TYPE,\r\n            children: [],\r\n            attrs,\r\n            parent: null\r\n        }\r\n    }\r\n    // 利用栈型结构 来构造一颗树\r\n    function start(tag, attrs) {\r\n        let node =  createASTElement(tag,attrs); // 创造一个ast节点\r\n        if(!root){ // 看一下是否是空树\r\n            root = node; // 如果为空则当前是树的根节点\r\n        } \r\n        if(currentParent){\r\n            node.parent = currentParent; // 只赋予了parent属性\r\n            currentParent.children.push(node); // 还需要让父亲记住自己\r\n        }\r\n        stack.push(node);\r\n        currentParent = node; // currentParent为栈中的最后一个\r\n    }\r\n    function chars(text) { // 文本直接放到当前指向的节点中\r\n        text = text.replace(/\\s/g,''); // 如果空格超过2就删除2个以上的\r\n        text && currentParent.children.push({\r\n            type:TEXT_TYPE,\r\n            text,\r\n            parent:currentParent\r\n        });\r\n    }\r\n    function end(tag) {\r\n       let node =  stack.pop();  // 弹出最后一个, 校验标签是否合法\r\n       currentParent = stack[stack.length - 1];\r\n    }\r\n    function advance(n) {\r\n        html = html.substring(n);\r\n    }\r\n    function parseStartTag() {\r\n        const start = html.match(startTagOpen);\r\n        if (start) {\r\n            const match = {\r\n                tagName: start[1], // 标签名\r\n                attrs: []\r\n            }\r\n            advance(start[0].length);\r\n            // 如果不是开始标签的结束 就一直匹配下去\r\n            let attr, end\r\n            while (!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\r\n                advance(attr[0].length);\r\n                match.attrs.push({ name: attr[1], value: attr[3] || attr[4] || attr[5] || true })\r\n            }\r\n            if (end) {\r\n                advance(end[0].length)\r\n            }\r\n            return match;\r\n        }\r\n        return false; // 不是开始标签\r\n    }\r\n    while (html) {\r\n        // 如果textEnd 为0 说明是一个开始标签或者结束标签\r\n        // 如果textEnd > 0说明就是文本的结束位置\r\n        let textEnd = html.indexOf('<');  // 如果indexOf中的索引是0 则说明是个标签\r\n        if (textEnd == 0) {\r\n            const startTagMatch = parseStartTag(); // 开始标签的匹配结果\r\n            if (startTagMatch) { // 解析到的开始标签\r\n                start(startTagMatch.tagName, startTagMatch.attrs)\r\n                continue\r\n            }\r\n            let endTagMatch = html.match(endTag);\r\n            if (endTagMatch) {\r\n                advance(endTagMatch[0].length);\r\n                end(endTagMatch[1])\r\n                continue;\r\n            }\r\n        }\r\n        if (textEnd > 0) {\r\n            let text = html.substring(0, textEnd); // 文本内容\r\n            if (text) {\r\n                chars(text)\r\n                advance(text.length); // 解析到的文本 \r\n            }\r\n        }\r\n    }\r\n    \r\n\r\n    return root;\r\n}","import { parseHTML } from \"./parse\";\r\n\r\nfunction genProps(attrs) {\r\n    let str = ''// {name,value}\r\n    for (let i = 0; i < attrs.length; i++) {\r\n        let attr = attrs[i];\r\n        if (attr.name === 'style') {\r\n            // color:red;background:red => {color:'red'}\r\n            let obj = {};\r\n            attr.value.split(';').forEach(item => { // qs 库\r\n                let [key, value] = item.split(':');\r\n                obj[key] = value;\r\n            });\r\n            attr.value = obj\r\n        }\r\n        str += `${attr.name}:${JSON.stringify(attr.value)},` // a:b,c:d,\r\n    }\r\n    return `{${str.slice(0, -1)}}`\r\n}\r\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g; // {{ asdsadsa }}  匹配到的内容就是我们表达式的变量\r\nfunction gen(node) {\r\n    if (node.type === 1) {\r\n        return codegen(node);\r\n    } else {\r\n        // 文本\r\n        let text = node.text\r\n        if (!defaultTagRE.test(text)) {\r\n            return `_v(${JSON.stringify(text)})`\r\n        } else {\r\n            //_v( _s(name)+'hello' + _s(name))\r\n            let tokens = [];\r\n            let match;\r\n            defaultTagRE.lastIndex = 0;\r\n            let lastIndex = 0;\r\n            // split\r\n            while (match = defaultTagRE.exec(text)) {\r\n                let index = match.index; // 匹配的位置  {{name}} hello  {{name}} hello \r\n                if (index > lastIndex) {\r\n                    tokens.push(JSON.stringify(text.slice(lastIndex, index)))\r\n                }\r\n                tokens.push(`_s(${match[1].trim()})`)\r\n                lastIndex = index + match[0].length\r\n            }\r\n            if (lastIndex < text.length) {\r\n                tokens.push(JSON.stringify(text.slice(lastIndex)))\r\n            }\r\n            return `_v(${tokens.join('+')})`\r\n        }\r\n    }\r\n}\r\nfunction genChildren(children) {\r\n    return children.map(child => gen(child)).join(',')\r\n}\r\nfunction codegen(ast) {\r\n    let children = genChildren(ast.children);\r\n    let code = (`_c('${ast.tag}',${ast.attrs.length > 0 ? genProps(ast.attrs) : 'null'\r\n        }${ast.children.length ? `,${children}` : ''\r\n        })`)\r\n\r\n    return code;\r\n}\r\nexport function compileToFunction(template) {\r\n\r\n    // 1.就是将template 转化成ast语法树\r\n    let ast = parseHTML(template);\r\n\r\n    // 2.生成render方法 (render方法执行后的返回的结果就是 虚拟DOM)\r\n\r\n    // 模板引擎的实现原理 就是 with  + new Function\r\n\r\n    let code = codegen(ast);\r\n    code = `with(this){return ${code}}`;\r\n    let render = new Function(code); // 根据代码生成render函数\r\n\r\n    //  _c('div',{id:'app'},_c('div',{style:{color:'red'}},  _v(_s(vm.name)+'hello'),_c('span',undefined,  _v(_s(age))))\r\n\r\n    return render;\r\n}\r\n\r\n\r\n// <xxx\r\n// <namepsace:xxx\r\n// color   =   \"asdsada\"     c= 'asdasd'  d=  asdasdsa","\r\nlet id = 0;\r\nclass Dep{\r\n    constructor(){\r\n        this.id = id++; // 属性的dep要收集watcher\r\n        this.subs = [];// 这里存放着当前属性对应的watcher有哪些\r\n    }\r\n    depend(){\r\n        // 这里我们不希望放重复的watcher，而且刚才只是一个单向的关系 dep -> watcher\r\n        // watcher 记录dep\r\n        // this.subs.push(Dep.target);\r\n\r\n        Dep.target.addDep(this); // 让watcher记住dep\r\n\r\n        // dep 和 watcher是一个多对多的关系 （一个属性可以在多个组件中使用 dep -> 多个watcher）\r\n        // 一个组件中由多个属性组成 （一个watcher 对应多个dep）\r\n    }\r\n    addSub(watcher){\r\n        this.subs.push(watcher)\r\n    }\r\n    notify(){\r\n        this.subs.forEach(watcher=>watcher.update()); // 告诉watcher要更新了\r\n    }\r\n}\r\nDep.target = null;\r\nlet stack = [];\r\nexport function pushTarget(watcher){\r\n    stack.push(watcher);\r\n    Dep.target = watcher;\r\n}\r\nexport function popTarget(){\r\n    stack.pop();\r\n    Dep.target = stack[stack.length - 1];\r\n}\r\n\r\nexport default Dep;\r\n","import Dep, { popTarget, pushTarget } from \"./dep\";\r\n\r\nlet id = 0;\r\n\r\n// 1） 当我们创建渲染watcher的时候我们会把当前的渲染watcher放到Dep.target上\r\n// 2) 调用_render() 会取值 走到get上\r\n// 每个属性有一个dep （属性就是被观察者） ， watcher就是观察者（属性变化了会通知观察者来更新） -》 观察者模式\r\nclass Watcher { // 不同组件有不同的watcher   目前只有一个 渲染根实例的\r\n    constructor(vm, exprOrFn, options,cb) {\r\n        this.id = id++;\r\n        this.renderWatcher = options; // 是一个渲染watcher\r\n\r\n        if(typeof exprOrFn === 'string'){\r\n            this.getter = function(){\r\n                return vm[exprOrFn]\r\n            }\r\n        }else{\r\n            this.getter = exprOrFn; // getter意味着调用这个函数可以发生取值操作\r\n        }\r\n\r\n      \r\n        this.deps = [];  // 后续我们实现计算属性，和一些清理工作需要用到\r\n        this.depsId = new Set();\r\n        this.lazy = options.lazy;\r\n        this.cb = cb;\r\n        this.dirty = this.lazy; // 缓存值\r\n        this.vm = vm;\r\n        this.user = options.user; // 标识是否是用户自己的watcher\r\n\r\n        this.value = this.lazy ? undefined :  this.get();\r\n       \r\n    }\r\n    addDep(dep) { // 一个组件 对应着多个属性 重复的属性也不用记录\r\n        let id = dep.id;\r\n        if (!this.depsId.has(id)) {\r\n            this.deps.push(dep);\r\n            this.depsId.add(id);\r\n            dep.addSub(this); // watcher已经记住了dep了而且去重了，此时让dep也记住watcher\r\n        }\r\n    }\r\n    evaluate(){\r\n        this.value =  this.get(); // 获取到用户函数的返回值 并且还要标识为脏 \r\n        this.dirty = false;\r\n    }\r\n    get() {\r\n        pushTarget(this)// 静态属性就是只有一份\r\n        let value = this.getter.call(this.vm); // 会去vm上取值  vm._update(vm._render) 取name 和age\r\n        popTarget() // 渲染完毕后就清空\r\n        return value;\r\n    }\r\n    depend(){ // watcher的depend 就是让watcher中dep去depend\r\n        let i =  this.deps.length;\r\n        while(i--){\r\n            // dep.depend()\r\n            this.deps[i].depend(); // 让计算属性watcher 也收集渲染watcher\r\n        }\r\n    }\r\n    update() {\r\n        if(this.lazy){\r\n            // 如果是计算属性  依赖的值变化了 就标识计算属性是脏值了\r\n            this.dirty = true;\r\n        }else{\r\n            queueWatcher(this); // 把当前的watcher 暂存起来\r\n            // this.get(); // 重新渲染\r\n        }\r\n    }\r\n    run() {\r\n        let oldValue = this.value;\r\n        let newValue = this.get();  // 渲染的时候用的是最新的vm来渲染的\r\n        if(this.user){\r\n            this.cb.call(this.vm,newValue,oldValue);\r\n        }\r\n    }\r\n}\r\nlet queue = [];\r\nlet has = {};\r\nlet pending = false; // 防抖\r\nfunction flushSchedulerQueue() {\r\n    let flushQueue = queue.slice(0);\r\n    queue = [];\r\n    has = {};\r\n    pending = false;\r\n    flushQueue.forEach(q => q.run()); // 在刷新的过程中可能还有新的watcher，重新放到queue中\r\n}\r\nfunction queueWatcher(watcher) {\r\n    const id = watcher.id;\r\n    if (!has[id]) {\r\n        queue.push(watcher);\r\n        has[id] = true;\r\n        // 不管我们的update执行多少次 ，但是最终只执行一轮刷新操作\r\n        if (!pending) {\r\n            nextTick(flushSchedulerQueue, 0)\r\n            pending = true;\r\n        }\r\n    }\r\n}\r\nlet callbacks = [];\r\nlet waiting = false;\r\nfunction flushCallbacks() {\r\n    let cbs = callbacks.slice(0);\r\n    waiting = false;;\r\n    callbacks = [];\r\n    cbs.forEach(cb => cb()); // 按照顺序依次执行\r\n}\r\n\r\n// nextTick 没有直接使用某个api 而是采用优雅降级的方式 \r\n// 内部先采用的是promise （ie不兼容）  MutationObserver(h5的api)  可以考虑ie专享的 setImmediate  setTimeout\r\n\r\n// let timerFunc;\r\n// if (Promise) {\r\n//     timerFunc = () => {\r\n//         Promise.resolve().then(flushCallbacks)\r\n//     }\r\n// }else if(MutationObserver){\r\n//     let observer = new MutationObserver(flushCallbacks); // 这里传入的回调是异步执行的\r\n//     let textNode = document.createTextNode(1);\r\n//     observer.observe(textNode,{\r\n//         characterData:true\r\n//     });\r\n//     timerFunc = () => {\r\n//         textNode.textContent = 2;\r\n//     }\r\n// }else if(setImmediate){\r\n//     timerFunc = () => {\r\n//        setImmediate(flushCallbacks);\r\n//     }\r\n// }else{\r\n//     timerFunc = () => {\r\n//         setTimeout(flushCallbacks);\r\n//      }\r\n// }\r\nexport function nextTick(cb) { // 先内部还是先用户的？\r\n    callbacks.push(cb); // 维护nextTick中的cakllback方法\r\n    if (!waiting) {\r\n        // timerFunc()\r\n        Promise.resolve().then(flushCallbacks)\r\n        waiting = true\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n// 需要给每个属性增加一个dep， 目的就是收集watcher\r\n\r\n// 一个组件中 有多少个属性 （n个属性会对应一个视图） n个dep对应一个watcher\r\n// 1个属性 对应着多个组件  1个dep对应多个watcher\r\n// 多对多的关系\r\n\r\nexport default Watcher","\r\n// h()  _c()\r\n\r\nconst isReservedTag = (tag) => {\r\n    return ['a', 'div', 'p', 'button', 'ul', 'li', 'span'].includes(tag)\r\n}\r\nexport function createElementVNode(vm, tag, data, ...children) {\r\n    if (data == null) {\r\n        data = {}\r\n    }\r\n    let key = data.key;\r\n    if (key) {\r\n        delete data.key\r\n    }\r\n\r\n    if (isReservedTag(tag)) {\r\n        return vnode(vm, tag, key, data, children);\r\n    } else {\r\n        // 创造一个组件的虚拟节点  (包含组件的构造函数)\r\n        let Ctor = vm.$options.components[tag]; // 组件的构造函数\r\n        // Ctor就是组件的定义 可能是一个Sub类 还有可能是组件的obj选项\r\n        return createComponentVnode(vm, tag, key, data, children, Ctor);\r\n    }\r\n}\r\nfunction createComponentVnode(vm, tag, key, data, children, Ctor) {\r\n    if (typeof Ctor === 'object') {\r\n        Ctor = vm.$options._base.extend(Ctor)\r\n        // Ctor = Vue.extend(Ctor)\r\n    }\r\n    data.hook = {\r\n        init(vnode){ // 稍后创造真实节点的时候 如果是组件则调用此init方法\r\n            // 保存组件的实例到虚拟节点上\r\n            let instance = vnode.componentInstance =  new vnode.componentOptions.Ctor;\r\n            instance.$mount(); // instance.$el\r\n        }\r\n    }\r\n    return vnode(vm, tag, key, data, children, null, { Ctor })\r\n}\r\n// _v();\r\nexport function createTextVNode(vm, text) {\r\n    return vnode(vm, undefined, undefined, undefined, undefined, text);\r\n}\r\n// ast一样吗？ ast做的是语法层面的转化 他描述的是语法本身 (可以描述js css html)\r\n// 我们的虚拟dom 是描述的dom元素，可以增加一些自定义属性  (描述dom的)\r\nfunction vnode(vm, tag, key, data, children, text, componentOptions) {\r\n    return {\r\n        vm,\r\n        tag,\r\n        key,\r\n        data,\r\n        children,\r\n        text,\r\n        componentOptions // 组件的构造函数\r\n        // ....\r\n    }\r\n}\r\n\r\nexport function isSameVnode(vnode1, vnode2) {\r\n    return vnode1.tag === vnode2.tag && vnode1.key === vnode2.key;\r\n}","import { isSameVnode } from \".\";\r\n\r\n\r\nfunction createComponent(vnode) {\r\n    let i = vnode.data;\r\n    if ((i = i.hook) && (i = i.init)) { // data.hook.init \r\n        i(vnode); // 初始化组件 ， 找到init方法\r\n    }\r\n    if(vnode.componentInstance){\r\n        return true; // 说明是组件\r\n    }\r\n}\r\n\r\nexport function createElm(vnode) {\r\n    let { tag, data, children, text } = vnode;\r\n    if (typeof tag === 'string') { // 标签\r\n        // 创建真实元素 也要区分是组件还是元素\r\n        if (createComponent(vnode)) { // 组件  vnode.componentInstance.$el\r\n            return vnode.componentInstance.$el;\r\n        }\r\n        vnode.el = document.createElement(tag); // 这里将真实节点和虚拟节点对应起来，后续如果修改属性了\r\n        patchProps(vnode.el, {}, data);\r\n        children.forEach(child => {\r\n            vnode.el.appendChild(createElm(child)); // 会将组件创建的元素插入到父元素中\r\n        });\r\n    } else {\r\n        vnode.el = document.createTextNode(text)\r\n    }\r\n    return vnode.el\r\n}\r\nexport function patchProps(el, oldProps = {}, props = {}) {\r\n    // 老的属性中有，新的没有  要删除老的\r\n    let oldStyles = oldProps.style || {};\r\n    let newStyles = props.style || {};\r\n    for (let key in oldStyles) { // 老的样式中有 新的吗，没有则删除\r\n        if (!newStyles[key]) {\r\n            el.style[key] = ''\r\n        }\r\n    }\r\n\r\n    for (let key in oldProps) { // 老的属性中有\r\n        if (!props[key]) { // 新的没有删除属性\r\n            el.removeAttribute(key);\r\n        }\r\n    }\r\n    for (let key in props) { // 用新的覆盖老的\r\n        if (key === 'style') { // style{color:'red'}\r\n            for (let styleName in props.style) {\r\n                el.style[styleName] = props.style[styleName];\r\n            }\r\n        } else {\r\n            el.setAttribute(key, props[key]);\r\n        }\r\n    }\r\n\r\n}\r\nexport function patch(oldVNode, vnode) {\r\n    // mount()\r\n    if(!oldVNode){ // 这就是组件的挂载\r\n        return createElm(vnode); // vm.$el  对应的就是组件渲染的结果了\r\n    }\r\n\r\n    // 写的是初渲染流程 \r\n    const isRealElement = oldVNode.nodeType;\r\n    if (isRealElement) {\r\n        const elm = oldVNode; // 获取真实元素\r\n        const parentElm = elm.parentNode; // 拿到父元素\r\n        let newElm = createElm(vnode);\r\n        parentElm.insertBefore(newElm, elm.nextSibling);\r\n        parentElm.removeChild(elm); // 删除老节点\r\n\r\n        return newElm\r\n    } else {\r\n        // 1.两个节点不是同一个节点  直接删除老的换上新的  （没有比对了）\r\n        // 2.两个节点是同一个节点 (判断节点的tag和 节点的key)  比较两个节点的属性是否有差异 （复用老的节点，将差异的属性更新）\r\n        // 3.节点比较完毕后就需要比较两人的儿子\r\n        return patchVnode(oldVNode, vnode);\r\n    }\r\n}\r\n\r\nfunction patchVnode(oldVNode, vnode) {\r\n    if (!isSameVnode(oldVNode, vnode)) { // tag == tag key === key\r\n        // 用老节点的父亲 进行替换\r\n        let el = createElm(vnode);\r\n        oldVNode.el.parentNode.replaceChild(el, oldVNode.el)\r\n        return el;\r\n    }\r\n\r\n    // 文本的情况  文本我们期望比较一下文本的内容\r\n    let el = vnode.el = oldVNode.el; // 复用老节点的元素\r\n    if (!oldVNode.tag) { // 是文本\r\n        if (oldVNode.text !== vnode.text) {\r\n            el.textContent = vnode.text; // 用新的文本覆盖掉老的\r\n        }\r\n    }\r\n    // 是标签   是标签我们需要比对标签的属性\r\n    patchProps(el, oldVNode.data, vnode.data);\r\n\r\n    // 比较儿子节点 比较的时候 一方有儿子 一方没儿子 \r\n    //                       两方都有儿子\r\n\r\n\r\n    let oldChildren = oldVNode.children || [];\r\n    let newChildren = vnode.children || [];\r\n\r\n\r\n    if (oldChildren.length > 0 && newChildren.length > 0) {\r\n        // 完整的diff算法 需要比较两个人的儿子\r\n        updateChildren(el, oldChildren, newChildren);\r\n\r\n    } else if (newChildren.length > 0) { // 没有老的，有新的\r\n        mountChildren(el, newChildren);\r\n    } else if (oldChildren.length > 0) { // 新的没有  老的有 要删除\r\n        el.innerHTML = ''; // 可以循环删除\r\n    }\r\n    return el;\r\n}\r\n\r\nfunction mountChildren(el, newChildren) {\r\n    for (let i = 0; i < newChildren.length; i++) {\r\n        let child = newChildren[i];\r\n        el.appendChild(createElm(child))\r\n    }\r\n}\r\nfunction updateChildren(el, oldChildren, newChildren) {\r\n    // 我们操作列表 经常会是有  push shift pop unshift reverse sort这些方法  （针对这些情况做一个优化）\r\n    // vue2中采用双指针的方式 比较两个节点\r\n    let oldStartIndex = 0;\r\n    let newStartIndex = 0;\r\n    let oldEndIndex = oldChildren.length - 1;\r\n    let newEndIndex = newChildren.length - 1;\r\n\r\n    let oldStartVnode = oldChildren[0];\r\n    let newStartVnode = newChildren[0];\r\n\r\n    let oldEndVnode = oldChildren[oldEndIndex];\r\n    let newEndVnode = newChildren[newEndIndex];\r\n\r\n\r\n    function makeIndexByKey(children) {\r\n        let map = {\r\n\r\n        }\r\n        children.forEach((child, index) => {\r\n            map[child.key] = index;\r\n        });\r\n        return map;\r\n    }\r\n\r\n    let map = makeIndexByKey(oldChildren);\r\n\r\n\r\n\r\n\r\n    // 循环的时候为什么要+key\r\n    while (oldStartIndex <= oldEndIndex && newStartIndex <= newEndIndex) { // 有任何一个不满足则停止  || 有一个为true 就继续走\r\n        // 双方有一方头指针，大于尾部指针则停止循环\r\n        if (!oldStartVnode) {\r\n            oldStartVnode = oldChildren[++oldStartIndex]\r\n        } else if (!oldEndVnode) {\r\n            oldEndVnode = oldChildren[--oldEndIndex]\r\n        } else if (isSameVnode(oldStartVnode, newStartVnode)) {\r\n            patchVnode(oldStartVnode, newStartVnode); // 如果是相同节点 则递归比较子节点\r\n            oldStartVnode = oldChildren[++oldStartIndex];\r\n            newStartVnode = newChildren[++newStartIndex];\r\n            // 比较开头节点\r\n        } else if (isSameVnode(oldEndVnode, newEndVnode)) {\r\n            patchVnode(oldEndVnode, newEndVnode); // 如果是相同节点 则递归比较子节点\r\n            oldEndVnode = oldChildren[--oldEndIndex];\r\n            newEndVnode = newChildren[--newEndIndex];\r\n            // 比较开头节点\r\n        } else if (isSameVnode(oldEndVnode, newStartVnode)) {\r\n            patchVnode(oldEndVnode, newStartVnode);\r\n            // insertBefore 具备移动性 会将原来的元素移动走\r\n            el.insertBefore(oldEndVnode.el, oldStartVnode.el); // 将老的尾巴移动到老的前面去\r\n            oldEndVnode = oldChildren[--oldEndIndex];\r\n            newStartVnode = newChildren[++newStartIndex];\r\n        }\r\n        else if (isSameVnode(oldStartVnode, newEndVnode)) {\r\n            patchVnode(oldStartVnode, newEndVnode);\r\n            // insertBefore 具备移动性 会将原来的元素移动走\r\n            el.insertBefore(oldStartVnode.el, oldEndVnode.el.nextSibling); // 将老的尾巴移动到老的前面去\r\n            oldStartVnode = oldChildren[++oldStartIndex];\r\n            newEndVnode = newChildren[--newEndIndex];\r\n        } else {\r\n            // 在给动态列表添加key的时候 要尽量避免用索引，因为索引前后都是从0 开始 ， 可能会发生错误复用 \r\n            // 乱序比对\r\n            // 根据老的列表做一个映射关系 ，用新的去找，找到则移动，找不到则添加，最后多余的就删除\r\n            let moveIndex = map[newStartVnode.key]; // 如果拿到则说明是我要移动的索引\r\n            if (moveIndex !== undefined) {\r\n                let moveVnode = oldChildren[moveIndex]; // 找到对应的虚拟节点 复用\r\n                el.insertBefore(moveVnode.el, oldStartVnode.el);\r\n                oldChildren[moveIndex] = undefined; // 表示这个节点已经移动走了\r\n                patchVnode(moveVnode, newStartVnode); // 比对属性和子节点\r\n            } else {\r\n                el.insertBefore(createElm(newStartVnode), oldStartVnode.el);\r\n            }\r\n            newStartVnode = newChildren[++newStartIndex];\r\n        }\r\n\r\n    }\r\n    if (newStartIndex <= newEndIndex) { // 新的多了 多余的就插入进去\r\n        for (let i = newStartIndex; i <= newEndIndex; i++) {\r\n            let childEl = createElm(newChildren[i])\r\n            // 这里可能是像后追加 ，还有可能是向前追加\r\n            let anchor = newChildren[newEndIndex + 1] ? newChildren[newEndIndex + 1].el : null; // 获取下一个元素\r\n            // el.appendChild(childEl);\r\n            el.insertBefore(childEl, anchor); // anchor 为null的时候则会认为是appendChild\r\n        }\r\n    }\r\n\r\n    if (oldStartIndex <= oldEndIndex) { // 老的对了，需要删除老的\r\n        for (let i = oldStartIndex; i <= oldEndIndex; i++) {\r\n            if (oldChildren[i]) {\r\n                let childEl = oldChildren[i].el\r\n                el.removeChild(childEl);\r\n            }\r\n        }\r\n    }\r\n\r\n    // 我们为了 比较两个儿子的时候 ，增高性能 我们会有一些优化手段\r\n    // 如果批量像页面中修改出入内容 浏览器会自动优化 \r\n\r\n\r\n\r\n}","import Watcher from \"./observe/watcher\";\r\nimport { createElementVNode, createTextVNode } from \"./vdom\"\r\nimport { patch } from \"./vdom/patch\";\r\n\r\n\r\n\r\n\r\nexport function initLifeCycle(Vue){\r\n    Vue.prototype._update = function(vnode){ // 将vnode转化成真实dom\r\n        const vm = this;\r\n        const el = vm.$el;\r\n        const prevVnode = vm._vnode;\r\n        vm._vnode = vnode; // 把组件第一次产生的虚拟节点保存到_vnode上\r\n        if(prevVnode){ // 之前渲染过了\r\n            vm.$el = patch(prevVnode,vnode);\r\n        }else{\r\n            vm.$el = patch(el,vnode);\r\n        }\r\n    }\r\n\r\n    // _c('div',{},...children)\r\n    Vue.prototype._c = function(){\r\n       return  createElementVNode(this,...arguments)\r\n    }\r\n    // _v(text)\r\n    Vue.prototype._v = function(){\r\n        return createTextVNode(this,...arguments)\r\n    }\r\n    Vue.prototype._s = function(value){\r\n        if(typeof value !== 'object') return value\r\n        return JSON.stringify(value)\r\n    }\r\n    Vue.prototype._render = function(){\r\n        // 当渲染的时候会去实例中取值，我们就可以将属性和视图绑定在一起\r\n        \r\n        return this.$options.render.call(this); // 通过ast语法转义后生成的render方法\r\n    }\r\n}\r\n\r\nexport function mountComponent(vm,el){ // 这里的el 是通过querySelector处理过的\r\n    vm.$el = el;\r\n\r\n    // 1.调用render方法产生虚拟节点 虚拟DOM\r\n\r\n    const updateComponent = ()=>{\r\n        vm._update(vm._render()); // vm.$options.render() 虚拟节点\r\n    }\r\n\r\n    const watcher = new Watcher(vm,updateComponent,true); // true用于标识是一个渲染watcher\r\n    \r\n\r\n\r\n\r\n\r\n    // 2.根据虚拟DOM产生真实DOM \r\n\r\n    // 3.插入到el元素中\r\n\r\n}\r\n// vue核心流程 1） 创造了响应式数据  2） 模板转换成ast语法树  \r\n// 3) 将ast语法树转换了render函数 4) 后续每次数据更新可以只执行render函数 (无需再次执行ast转化的过程)\r\n// render函数会去产生虚拟节点（使用响应式数据）\r\n// 根据生成的虚拟节点创造真实的DOM\r\n\r\n\r\nexport function callHook(vm,hook){ // 调用钩子函数\r\n    const handlers = vm.$options[hook];\r\n    if(handlers){\r\n        handlers.forEach(handler=>handler.call(vm))\r\n    }\r\n}\r\n","// 我们希望重写数组中的部分方法\r\nlet oldArrayProto = Array.prototype; // 获取数组的原型\r\n// newArrayProto.__proto__  = oldArrayProto\r\nexport let newArrayProto = Object.create(oldArrayProto);\r\n\r\nlet methods = [ // 找到所有的变异方法\r\n    'push',\r\n    'pop',\r\n    'shift',\r\n    'unshift',\r\n    'reverse',\r\n    'sort',\r\n    'splice'\r\n] // concat slice 都不会改变原数组\r\nmethods.forEach(method => {\r\n    // arr.push(1,2,3)\r\n    newArrayProto[method] = function (...args) { // 这里重写了数组的方法\r\n        // push.call(arr)\r\n        // todo...\r\n        const result = oldArrayProto[method].call(this, ...args); // 内部调用原来的方法 ， 函数的劫持  切片编程\r\n        // 我们需要对新增的 数据再次进行劫持\r\n        let inserted;\r\n        let ob = this.__ob__;\r\n        switch (method) {\r\n            case 'push':\r\n            case 'unshift': // arr.unshift(1,2,3)\r\n                inserted = args;\r\n                break;\r\n            case 'splice':  // arr.splice(0,1,{a:1},{a:1})\r\n                inserted = args.slice(2);\r\n            default:\r\n                break;\r\n        }\r\n        // console.log(inserted); // 新增的内容\r\n        if(inserted) {\r\n            // 对新增的内容再次进行观测  \r\n            ob.observeArray(inserted);\r\n        }\r\n\r\n        // 走到这里 \r\n        ob.dep.notify(); // 数组变化了 通知对应的watcher实现更新逻辑\r\n        return result\r\n    }\r\n})","import { newArrayProto } from \"./array\";\r\nimport Dep from \"./dep\";\r\n\r\nclass Observer{\r\n    constructor(data){\r\n\r\n        // 给每个对象都增加收集功能 \r\n        \r\n        this.dep = new Dep(); // 所有对象都要增加dep\r\n\r\n\r\n        // Object.defineProperty只能劫持已经存在的属性 （vue里面会为此单独写一些api  $set $delete）\r\n        Object.defineProperty(data,'__ob__',{\r\n            value:this,\r\n            enumerable:false // 将__ob__ 变成不可枚举 （循环的时候无法获取到）\r\n        });\r\n        // data.__ob__ = this; // 给数据加了一个标识 如果数据上有__ob__ 则说明这个属性被观测过了\r\n        if(Array.isArray(data)){\r\n            // 这里我们可以重写数组中的方法 7个变异方法 是可以修改数组本身的\r\n            data.__proto__ =  newArrayProto  // 需要保留数组原有的特性，并且可以重写部分方法\r\n            this.observeArray(data); // 如果数组中放的是对象 可以监控到对象的变化\r\n        }else{\r\n            this.walk(data);\r\n        }\r\n    }\r\n\r\n    walk(data){ // 循环对象 对属性依次劫持\r\n        // \"重新定义\"属性   性能差\r\n        Object.keys(data).forEach(key=> defineReactive(data,key,data[key]))\r\n    }\r\n    observeArray(data){ // 观测数组\r\n        data.forEach(item=> observe(item))\r\n    }\r\n}\r\n// 深层次嵌套会递归，递归多了性能差，不存在属性监控不到，存在的属性要重写方法  vue3-> proxy\r\nfunction dependArray(value){\r\n    for(let i = 0; i < value.length;i++){\r\n        let current = value[i]\r\n        current.__ob__ && current.__ob__.dep.depend();\r\n        if(Array.isArray(current)){\r\n            dependArray(current);\r\n        }\r\n    }\r\n}\r\n\r\nexport function defineReactive(target,key,value){ // 闭包  属性劫持\r\n    let childOb = observe(value); // 对所有的对象都进行属性劫持  childOb.dep 用来收集依赖的\r\n    let dep = new Dep(); // 每一个属性都有一个dep\r\n    Object.defineProperty(target,key,{\r\n        get(){ // 取值的时候 会执行get\r\n            if(Dep.target){\r\n                dep.depend(); // 让这个属性的收集器记住当前的watcher\r\n                if(childOb){\r\n                    childOb.dep.depend(); // 让数组和对象本身也实现依赖收集\r\n                    if(Array.isArray(value)){\r\n                        dependArray(value);\r\n                    }\r\n                }\r\n            }\r\n            return value\r\n        },\r\n        set(newValue){ // 修改的时候 会执行set\r\n            if(newValue === value) return\r\n            observe(newValue)\r\n            value = newValue\r\n            dep.notify(); // 通知更新\r\n        }\r\n    })\r\n}\r\nexport function observe(data){\r\n    // 对这个对象进行劫持\r\n    if(typeof data !== 'object' || data == null){\r\n        return; // 只对对象进行劫持\r\n    }\r\n    if(data.__ob__ instanceof Observer){ // 说明这个对象被代理过了\r\n        return data.__ob__;\r\n    }\r\n    // 如果一个对象被劫持过了，那就不需要再被劫持了 (要判断一个对象是否被劫持过，可以增添一个实例，用实例来判断是否被劫持过)\r\n\r\n    return new Observer(data);\r\n\r\n}\r\n","import Dep from \"./observe/dep\";\r\nimport { observe } from \"./observe/index\";\r\nimport Watcher, { nextTick } from './observe/watcher'\r\n\r\nexport function initState(vm) {\r\n    const opts = vm.$options; // 获取所有的选项\r\n    if (opts.data) {\r\n        initData(vm);\r\n    }\r\n    if (opts.computed) {\r\n        initComputed(vm);\r\n    }\r\n    if (opts.watch) {\r\n        initWatch(vm);\r\n    }\r\n}\r\nfunction initWatch(vm) {\r\n    let watch = vm.$options.watch;\r\n    for (let key in watch) {\r\n        const handler = watch[key]; // 字符串 数组 函数\r\n        if (Array.isArray(handler)) {\r\n            for (let i = 0; i < handler.length; i++) {\r\n                createWatcher(vm, key, handler[i]);\r\n            }\r\n        } else {\r\n            createWatcher(vm, key, handler);\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\nfunction createWatcher(vm, key, handler) {\r\n    // 字符串  函数\r\n    if (typeof handler === 'string') {\r\n        handler = vm[handler];\r\n    }\r\n    return vm.$watch(key, handler)\r\n}\r\n\r\n\r\nfunction proxy(vm, target, key) {\r\n    Object.defineProperty(vm, key, { // vm.name\r\n        get() {\r\n            return vm[target][key]; // vm._data.name\r\n        },\r\n        set(newValue) {\r\n            vm[target][key] = newValue\r\n        }\r\n    })\r\n}\r\nfunction initData(vm) {\r\n    let data = vm.$options.data; // data可能是函数和对象\r\n    data = typeof data === 'function' ? data.call(vm) : data; // data是用户返回的对象\r\n\r\n    vm._data = data; // 我将返回的对象放到了_data上\r\n    // 对数据进行劫持 vue2 里采用了一个api defineProperty\r\n    observe(data)\r\n\r\n    // 将vm._data 用vm来代理就可以了 \r\n    for (let key in data) {\r\n        proxy(vm, '_data', key);\r\n    }\r\n}\r\n\r\nfunction initComputed(vm) {\r\n    const computed = vm.$options.computed;\r\n    const watchers = vm._computedWatchers = {}; // 将计算属性watcher保存到vm上\r\n    for (let key in computed) {\r\n        let userDef = computed[key];\r\n\r\n        // 我们需要监控 计算属性中get的变化\r\n        let fn = typeof userDef === 'function' ? userDef : userDef.get\r\n\r\n        // 如果直接new Watcher 默认就会执行fn, 将属性和watcher对应起来 \r\n        watchers[key] = new Watcher(vm, fn, { lazy: true })\r\n\r\n        defineComputed(vm, key, userDef);\r\n    }\r\n}\r\nfunction defineComputed(target, key, userDef) {\r\n    // const getter = typeof userDef === 'function' ? userDef : userDef.get;\r\n    const setter = userDef.set || (() => { })\r\n\r\n    // 可以通过实例拿到对应的属性\r\n    Object.defineProperty(target, key, {\r\n        get: createComputedGetter(key),\r\n        set: setter\r\n    })\r\n}\r\n\r\n\r\n// 计算属性根本不会收集依赖 ，只会让自己的依赖属性去收集依赖\r\nfunction createComputedGetter(key) {\r\n    // 我们需要检测是否要执行这个getter\r\n    return function () {\r\n        const watcher = this._computedWatchers[key]; // 获取到对应属性的watcher\r\n        if (watcher.dirty) {\r\n            // 如果是脏的就去执行 用户传入的函数\r\n            watcher.evaluate(); // 求值后 dirty变为了false ,下次就不求值了\r\n        }\r\n        if (Dep.target) { // 计算属性出栈后 还要渲染watcher， 我应该让计算属性watcher里面的属性 也去收集上一层watcher\r\n            watcher.depend();\r\n        }\r\n        return watcher.value; // 最后返回的是watcher上的值\r\n    }\r\n}\r\n\r\nexport function initStateMixin(Vue) {\r\n    Vue.prototype.$nextTick = nextTick;\r\n    // 最终调用的都是这个方法\r\n    Vue.prototype.$watch = function (exprOrFn, cb) {\r\n        // firstname\r\n        // ()=>vm.firstname\r\n\r\n        // firstname的值变化了 直接执行cb函数即可\r\n        new Watcher(this, exprOrFn, { user: true }, cb)\r\n    }\r\n}","import { compileToFunction } from \"./compiler\";\r\nimport { callHook, mountComponent } from \"./lifecycle\";\r\nimport { initState } from \"./state\";\r\nimport { mergeOptions } from \"./utils\";\r\n\r\n\r\nexport function initMixin(Vue) { // 就是给Vue增加init方法的\r\n    Vue.prototype._init = function (options) { // 用于初始化操作\r\n        // vue  vm.$options 就是获取用户的配置 \r\n        // 我们使用的 vue的时候 $nextTick $data $attr.....\r\n        const vm = this;\r\n\r\n        // 我们定义的全局指令和过滤器.... 都会挂载到实力上\r\n\r\n        //    Sub.options,options\r\n        vm.$options = mergeOptions(this.constructor.options,options); // 将用户的选项挂载到实例上\r\n\r\n\r\n        callHook(vm,'beforeCreate'); // 内部调用的是beforeCreate 写错了就不执行了\r\n        // 初始化状态, 初始化计算属性,watch\r\n        initState(vm);\r\n        callHook(vm,'created');\r\n\r\n        if (options.el) {\r\n            vm.$mount(options.el); // 实现数据的挂载\r\n        }\r\n    }\r\n    Vue.prototype.$mount = function (el) {\r\n        const vm = this;\r\n        el = document.querySelector(el);\r\n        let ops = vm.$options\r\n        if (!ops.render) { // 先进行查找有没有render函数 \r\n            let template; // 没有render看一下是否写了tempate, 没写template采用外部的template\r\n            if (!ops.template && el) { // 没有写模板 但是写了el\r\n                template = el.outerHTML\r\n            }else{\r\n                template = ops.template // 如果有el 则采用模板的内容\r\n            }\r\n            // 写了temlate 就用 写了的template\r\n            if(template){ // 只要有模板就挂载\r\n                // 这里需要对模板进行编译 \r\n                const render = compileToFunction(template);\r\n                ops.render = render; // jsx 最终会被编译成h('xxx')\r\n            }\r\n        }\r\n        mountComponent(vm,el); // 组件的挂载  \r\n         // 最终就可以获取render方法\r\n        // script 标签引用的vue.global.js 这个编译过程是在浏览器运行的\r\n        // runtime是不包含模板编译的, 整个编译是打包的时候通过loader来转义.vue文件的, 用runtime的时候不能使用template\r\n\r\n    }\r\n}\r\n\r\n","import { initGlobalAPI } from \"./gloablAPI\";\r\nimport { initMixin } from \"./init\";\r\nimport { initLifeCycle } from \"./lifecycle\";\r\n\r\nimport { initStateMixin } from \"./state\";\r\n\r\n\r\n// 将所有的方法都耦合在一起\r\nfunction Vue(options) { // options就是用户的选项\r\n    this._init(options); // 默认就调用了init\r\n}\r\n\r\n\r\ninitMixin(Vue); // 扩展了init方法\r\ninitLifeCycle(Vue); // vm_update  vm._render\r\ninitGlobalAPI(Vue) // 全局api的实现\r\ninitStateMixin(Vue); // 实现了nextTick $watch\r\n\r\n\r\n\r\n\r\nexport default Vue"],"names":["strats","LIFECYCLE","forEach","hook","p","c","concat","components","parentVal","childVal","res","Object","create","key","mergeOptions","parent","child","options","mergeField","hasOwnProperty","initGlobalAPI","Vue","_base","mixin","extend","Sub","_init","prototype","constructor","component","id","definition","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","parseHTML","html","ELEMENT_TYPE","TEXT_TYPE","stack","currentParent","root","createASTElement","tag","attrs","type","children","start","node","push","chars","text","replace","end","pop","length","advance","n","substring","parseStartTag","match","tagName","attr","name","value","textEnd","indexOf","startTagMatch","endTagMatch","genProps","str","i","obj","split","item","JSON","stringify","slice","defaultTagRE","gen","codegen","test","tokens","lastIndex","exec","index","trim","join","genChildren","map","ast","code","compileToFunction","template","render","Function","Dep","subs","target","addDep","watcher","update","pushTarget","popTarget","Watcher","vm","exprOrFn","cb","renderWatcher","getter","deps","depsId","Set","lazy","dirty","user","undefined","get","dep","has","add","addSub","call","depend","queueWatcher","oldValue","newValue","queue","pending","flushSchedulerQueue","flushQueue","q","run","nextTick","callbacks","waiting","flushCallbacks","cbs","Promise","resolve","then","isReservedTag","includes","createElementVNode","data","vnode","Ctor","$options","createComponentVnode","init","instance","componentInstance","componentOptions","$mount","createTextVNode","isSameVnode","vnode1","vnode2","createComponent","createElm","$el","el","document","createElement","patchProps","appendChild","createTextNode","oldProps","props","oldStyles","style","newStyles","removeAttribute","styleName","setAttribute","patch","oldVNode","isRealElement","nodeType","elm","parentElm","parentNode","newElm","insertBefore","nextSibling","removeChild","patchVnode","replaceChild","textContent","oldChildren","newChildren","updateChildren","mountChildren","innerHTML","oldStartIndex","newStartIndex","oldEndIndex","newEndIndex","oldStartVnode","newStartVnode","oldEndVnode","newEndVnode","makeIndexByKey","moveIndex","moveVnode","childEl","anchor","initLifeCycle","_update","prevVnode","_vnode","_c","arguments","_v","_s","_render","mountComponent","updateComponent","callHook","handlers","handler","oldArrayProto","Array","newArrayProto","methods","method","args","result","inserted","ob","__ob__","observeArray","notify","Observer","defineProperty","enumerable","isArray","__proto__","walk","keys","defineReactive","observe","dependArray","current","childOb","set","initState","opts","initData","computed","initComputed","watch","initWatch","createWatcher","$watch","proxy","_data","watchers","_computedWatchers","userDef","fn","defineComputed","setter","createComputedGetter","evaluate","initStateMixin","$nextTick","initMixin","querySelector","ops","outerHTML"],"mappings":"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"}